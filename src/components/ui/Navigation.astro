---
import MobileMenu from './MobileMenu';

const navItems = [
  { name: 'Home', href: '#home' },
  { name: 'About', href: '#about' },
  { name: 'Work', href: '#work' },
  { name: 'Contact', href: '#contact' },
];
---

<!-- Desktop Navigation -->
<nav
  id="main-nav"
  class="glass-liquid-strong rounded-full px-6 py-3 transition-all duration-300 sticky top-4 left-1/2 -translate-x-1/2 z-50 hidden md:flex w-fit"
>
  <ul class="flex items-center gap-8">
    {navItems.map((item) => (
      <li>
        <a
          href={item.href}
          class="nav-link text-xs uppercase tracking-[0.2em] text-white/70 hover:text-white transition-colors relative py-1"
          data-section={item.href.replace('#', '')}
        >
          {item.name}
          <span class="absolute -bottom-1 left-0 h-0.5 w-0 bg-linear-to-r from-primary-400 to-accent-400 transition-all duration-300 nav-indicator"></span>
        </a>
      </li>
    ))}
  </ul>
</nav>

<!-- Mobile Menu -->
<div class="md:hidden">
  <MobileMenu client:load />
</div>

<script is:inline>
  const sections = ['home', 'about', 'work', 'contact'];
  const navLinks = document.querySelectorAll('.nav-link');

  function updateActiveLink() {
    let current = sections.find((section) => {
      const el = document.getElementById(section);
      if (!el) return false;
      const rect = el.getBoundingClientRect();
      return rect.top <= 120 && rect.bottom >= 120;
    });

    navLinks.forEach((link) => {
      const isActive = link.dataset.section === current;
      link.classList.toggle('active', Boolean(isActive));
    });
  }

  window.addEventListener('scroll', updateActiveLink, { passive: true });
  window.addEventListener('load', updateActiveLink);
</script>

<style>
  .nav-link.active {
    color: white;
  }

  .nav-link.active .nav-indicator {
    width: 100%;
  }
</style>
